<!DOCTYPE html>
<html>
<head>
    <title>User Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">

    <div class="card shadow">
        <div class="card-header bg-dark text-white d-flex justify-content-between">
            <h4>User Management</h4>
            <a href="/create" class="btn btn-success btn-sm">+ Add User</a>
        </div>

        <div class="card-body">

            <!-- Search + Limit -->
            <form method="get" action="/" class="row mb-3">
                <div class="col-md-6">
                    <input type="text" name="search" value="<%= search %>" 
                    class="form-control" placeholder="Search by name/email/phone">
                </div>

                <div class="col-md-3">
                    <select name="limit" class="form-select">
                        <option value="5">Show 5</option>
                        <option value="10">Show 10</option>
                        <option value="15">Show 15</option>
                    </select>
                </div>

                <div class="col-md-3">
                    <button class="btn btn-primary w-100">Filter</button>
                </div>
            </form>

            <!-- Table -->
            <form method="post" action="/multi-delete">

            <table class="table table-bordered table-hover text-center align-middle">
                <thead class="table-dark">
                    <tr>
                        <th><input type="checkbox" onclick="toggle(this)"></th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Image</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>

                <tbody>
                <% users.forEach(user => { %>
                    <tr>
                        <td><input type="checkbox" name="ids" value="<%= user._id %>"></td>

                        <td><%= user.name %></td>
                        <td><%= user.email %></td>
                        <td><%= user.phone %></td>

                        <td>
                            <% if(user.image){ %>
                                <img src="/<%= user.image %>" 
                                width="50" height="50" 
                                class="rounded-circle border">
                            <% } %>
                        </td>

                        <td>
                            <% if(user.status){ %>
                                <span class="badge bg-success">Active</span>
                            <% } else { %>
                                <span class="badge bg-danger">Deleted</span>
                            <% } %>
                        </td>

                        <td>
                            <a href="/delete/<%= user._id %>" 
                               class="btn btn-danger btn-sm">
                               Delete
                            </a>
                        </td>
                    </tr>
                <% }) %>
                </tbody>
            </table>

            <button class="btn btn-warning">Multiple Delete</button>

            </form>

        </div>
    </div>

</div>

<script>
function toggle(source) {
    checkboxes = document.getElementsByName('ids');
    for(var i=0, n=checkboxes.length;i<n;i++) {
        checkboxes[i].checked = source.checked;
    }
}
</script>

</body>
</html>